
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jsramosvt.github.io/bel-mkdocs/Molecular%20Dynamics/GROMACS/PCA/">
      
      
        <link rel="prev" href="../../../default/">
      
      
        <link rel="next" href="../RMS/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.13">
    
    
      
        <title>Principal Component Analysis (PCA) - Documentation Mock-up</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e359304.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 12a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M6 13h8l-3.5 3.5 1.42 1.42L17.84 12l-5.92-5.92L10.5 7.5 14 11H6v2Z"/></svg>');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#principal-component-analysis-pca" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Documentation Mock-up" class="md-header__button md-logo" aria-label="Documentation Mock-up" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Documentation Mock-up
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Principal Component Analysis (PCA)
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../default/" class="md-tabs__link">
        
  
    
  
  Welcome to MkDocs

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Molecular Dynamics

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Documentation Mock-up" class="md-nav__button md-logo" aria-label="Documentation Mock-up" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Documentation Mock-up
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../default/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to MkDocs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Molecular Dynamics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Molecular Dynamics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GROMACS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            GROMACS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Principal Component Analysis (PCA)
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Principal Component Analysis (PCA)
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initial-set-up" class="md-nav__link">
    <span class="md-ellipsis">
      Initial set-up
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Initial set-up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concatenate-trajectory-files" class="md-nav__link">
    <span class="md-ellipsis">
      Concatenate trajectory files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-backbone-only-trajectory-xtc" class="md-nav__link">
    <span class="md-ellipsis">
      Get backbone-only trajectory (.xtc)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-backbone-only-topology-file-tpr" class="md-nav__link">
    <span class="md-ellipsis">
      Get backbone-only topology file (.tpr)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#covariance-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Covariance analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis-of-eigenvectors" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis of eigenvectors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-visualization-and-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Data visualization and analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data visualization and analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphing-2d-projections" class="md-nav__link">
    <span class="md-ellipsis">
      Graphing 2D projections
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Graphing 2D projections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-mdpcapy" class="md-nav__link">
    <span class="md-ellipsis">
      Using mdpca.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualizing-extreme-structures-with-pymol" class="md-nav__link">
    <span class="md-ellipsis">
      Visualizing extreme structures with PyMOL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualizing extreme structures with PyMOL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-modevectorspy" class="md-nav__link">
    <span class="md-ellipsis">
      Using modevectors.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-modesplitpy" class="md-nav__link">
    <span class="md-ellipsis">
      Using modesplit.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyzing-motion-with-direct-id" class="md-nav__link">
    <span class="md-ellipsis">
      Analyzing motion with DIRECT-ID
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RMS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Root Mean Square Deviation and Fluctuation (RMSD/RMSF)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Miscellaneous
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initial-set-up" class="md-nav__link">
    <span class="md-ellipsis">
      Initial set-up
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Initial set-up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concatenate-trajectory-files" class="md-nav__link">
    <span class="md-ellipsis">
      Concatenate trajectory files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-backbone-only-trajectory-xtc" class="md-nav__link">
    <span class="md-ellipsis">
      Get backbone-only trajectory (.xtc)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-backbone-only-topology-file-tpr" class="md-nav__link">
    <span class="md-ellipsis">
      Get backbone-only topology file (.tpr)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#covariance-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Covariance analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis-of-eigenvectors" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis of eigenvectors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-visualization-and-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Data visualization and analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data visualization and analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphing-2d-projections" class="md-nav__link">
    <span class="md-ellipsis">
      Graphing 2D projections
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Graphing 2D projections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-mdpcapy" class="md-nav__link">
    <span class="md-ellipsis">
      Using mdpca.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualizing-extreme-structures-with-pymol" class="md-nav__link">
    <span class="md-ellipsis">
      Visualizing extreme structures with PyMOL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualizing extreme structures with PyMOL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-modevectorspy" class="md-nav__link">
    <span class="md-ellipsis">
      Using modevectors.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-modesplitpy" class="md-nav__link">
    <span class="md-ellipsis">
      Using modesplit.py
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyzing-motion-with-direct-id" class="md-nav__link">
    <span class="md-ellipsis">
      Analyzing motion with DIRECT-ID
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="principal-component-analysis-pca">Principal Component Analysis (PCA)</h1>
<h2 id="introduction">Introduction</h2>
<p>Principal component analysis (PCA) allows us to identify major changes in conformation and movement after MD simulation.</p>
<p>This guide assumes you have <em>all files in the same directory</em>. If not, be sure to reference each file from their respective directories â€“ though it will be much easier later if all files are in the same directory.</p>
<p>Small systems will be able to do the initial set-up, <code>gmx covar</code>, and <code>gmx anaeig</code> within the same interactive session. If you have very large/complex systems you wish to compare, you may need to submit a slurm job to run these commands.</p>
<p>Interactive sessions allow us to use an allocation of ARC to actively submit commands, rather than queueing a job and waiting.</p>
<p>To begin an interactive session of 2 hours:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>interact<span class="w"> </span>-p<span class="w"> </span>v100_dev_q<span class="w"> </span>-A<span class="w"> </span>bevanlab<span class="w"> </span>--gres<span class="o">=</span>gpu:1<span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>--ntasks-per-node<span class="o">=</span><span class="m">12</span><span class="w"> </span>-t<span class="w"> </span><span class="m">2</span>:00:00
</span></code></pre></div>
<p>Then import the necessary modules (copy and paste <em>individual</em> lines to the command line):</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>module<span class="w"> </span>load<span class="w"> </span>apps<span class="w"> </span>site/infer/easybuild/setup
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>module<span class="w"> </span>load<span class="w"> </span>CMake/3.15.3-GCCcore-8.3.0
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>module<span class="w"> </span>load<span class="w"> </span>CUDA/10.1.243-GCC-8.3.0
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">MODULEPATH</span><span class="o">=</span><span class="nv">$MODULEPATH</span>:/projects/bevanlab/software/infer/modules/modules/infer-skylake/all
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>module<span class="w"> </span>load<span class="w"> </span>gromacs-v100/2020.4
</span></code></pre></div>
<h2 id="initial-set-up">Initial set-up</h2>
<p>You should have the following files from your MD simulations:</p>
<ul>
<li>Final trajectory files (.xtc) for all replicates</li>
<li>Topology file (.tpr) from any replicate</li>
</ul>
<h3 id="concatenate-trajectory-files">Concatenate trajectory files</h3>
<p>All trajectory (.xtc) replicates must be concatenated, or joined together, in order to analyze the average motion of your system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You <strong>MUST</strong> use the <code>-cat</code> option, otherwise duplicate timeframes will be overwritten by the last XTC file used.</p>
</div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>gmx trjcat -f rep1.xtc rep2.xtc rep3.xtc -cat -o all_cat.xtc
</span></code></pre></div>
<h3 id="get-backbone-only-trajectory-xtc">Get backbone-only trajectory (.xtc)</h3>
<p>Since covariance analysis is performed on the protein backbone, you will need to generate an xtc trajectory file containing the protein backbone only.</p>
<p>To generate a backbone-only XTC file:</p>
<p>To generate a backbone-only XTC file:
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>gmx trjconv -s topology.tpr -f all_cat.xtc -o all_cat_backbone.xtc
</span></code></pre></div></p>
<p>Select backbone when prompted.</p>
<h3 id="get-backbone-only-topology-file-tpr">Get backbone-only topology file (.tpr)</h3>
<p>The topology (.tpr) and trajectory (.xtc) files MUST match in atom count, otherwise you will get a fatal error when trying to run <code>gmx covar</code>.</p>
<p>To guarantee a match, create a backbone-only TPR file:
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>gmx convert-tpr -s topology.tpr -o backbone.tpr
</span></code></pre></div></p>
<p>Select backbone when prompted. It does not matter which TPR file is used (whether replicate 1 or 3), as <code>gmx covar</code> will only be referencing the structural information.</p>
<h2 id="covariance-analysis">Covariance analysis</h2>
<p>You need the new concatenated backbone-only XTC and TPR files generated in the initial set-up to perform covariance analysis. Because this step generates many files, it is advisable to make a new directory (e.g., <code>covar/</code>) to store your outputs.</p>
<p>To perform covariance analysis:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>gmx covar -f all_cat_backbone.xtc -s backbone.tpr -o ./covar/eigenval.xvg -ascii ./covar/ascii.dat -av ./covar/ave.pdb -v ./covar/eigenvec.trr
</span></code></pre></div>
<p>Select backbone when prompted.</p>
<p>This produces the following outputs:</p>
<ul>
<li><code>-o</code>: eigenvalues of the covariance matrix</li>
<li><code>-ascii</code>: the whole covariance matrix, in text form</li>
<li><code>-av</code>: the average structure</li>
<li><code>-v</code>: the full precision trajectory</li>
</ul>
<p>Repeat this for all systems. Be sure to use a clear naming convention, as this data will be projected onto each other in the next step.</p>
<h2 id="analysis-of-eigenvectors">Analysis of eigenvectors</h2>
<p>In order to analyze changes in motion during simulation, the outputs from the previous step must be processed using <code>gmx anaeig</code>.</p>
<p>The following files are needed for every system you plan to compare:</p>
<ul>
<li><code>backbone.xtc</code></li>
<li><code>eigenval.xvg</code></li>
<li><code>ave.pdb</code></li>
<li><code>eigenvect.trr</code></li>
</ul>
<p>To perform eigenvector analysis:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># Project MUT onto WT</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>gmx<span class="w"> </span>anaeig<span class="w"> </span>-s<span class="w"> </span>wt_ave.pdb<span class="w"> </span>-f<span class="w"> </span>mut_backbone.xtc<span class="w"> </span>-v<span class="w"> </span>wt_eigenvec.trr<span class="w"> </span>-eig<span class="w"> </span>wt_eigenval.xvg<span class="w"> </span>-proj<span class="w"> </span>mut_wt_proj-ev.xvg<span class="w"> </span>-extr<span class="w"> </span>mut_wt_ev.pdb<span class="w"> </span>-2d<span class="w"> </span>mut_wt_eigtraj.xvg<span class="w"> </span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c1"># Project WT onto MUT</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>gmx<span class="w"> </span>anaeig<span class="w"> </span>-s<span class="w"> </span>mut_ave.pdb<span class="w"> </span>-f<span class="w"> </span>wt_backbone.xtc<span class="w"> </span>-v<span class="w"> </span>mut_eigenvec.trr<span class="w"> </span>-eig<span class="w"> </span>mut_eigenval.xvg<span class="w"> </span>-proj<span class="w"> </span>wt_mut_proj-ev.xvg<span class="w"> </span>-extr<span class="w"> </span>wt_mut_ev.pdb<span class="w"> </span>-2d<span class="w"> </span>wt_mut_eigtraj.xvg
</span></code></pre></div>
<p>Select backbone, protein, or system when prompted (these are all the same).</p>
<p>This produces the following outputs:</p>
<ul>
<li><code>-proj</code>: the projections of trajectories on the first and last eigenvectors</li>
<li><code>-extr</code>: the two extreme projections along the average structure</li>
<li><code>-2d</code>: 2D projection of trajectories on the eigenvectors</li>
</ul>
<h2 id="data-visualization-and-analysis">Data visualization and analysis</h2>
<h3 id="graphing-2d-projections">Graphing 2D projections</h3>
<p>You will need the <code>mdpca.py</code> file to create PCA graphs from the 2D projection data. A version of this file is available (somewhere). You will also need a way to run Python 3 scripts.</p>
<p>The following files are needed for every system you plan to compare:</p>
<ul>
<li><code>eigtraj.xvg</code></li>
</ul>
<p>All relevant files must be in the same directory as the script OR use a path to the file.</p>
<h4 id="using-mdpcapy">Using <code>mdpca.py</code></h4>
<p>Open the script in a code editor and configure the following:</p>
<ol>
<li>Under <code>#2D INPUT FILES</code>, change file names to match the two <code>eigtraj.xvg</code> files.</li>
<li>Under <code>#GRAPH COLORS</code>, change the hex codes to adjust graph colors.</li>
<li>Under <code>#TITLE AND FILE PARAMETERS</code>, change the graph title and output file name.<ul>
<li>The graph title can be styled using Mathtext or LaTeX.</li>
<li>By default, graphs are saved as PNG files.</li>
</ul>
</li>
</ol>
<p>Save and run the script. The output will be two side-by-side projection graphs with a single title:</p>
<p><img alt="Example of PCA graph output" src="../../../assets/pca/pca_2d.png" /></p>
<p>The degree of overlap between the two datasets represents how structurally similar the systems are during simulation. Overlap in the data suggests these simulations take on more similar structures, or sample similar conformational space. Conversely, regions without overlap indicate differences in conformation.</p>
<h3 id="visualizing-extreme-structures-with-pymol">Visualizing extreme structures with PyMOL</h3>
<p>The conformational changes indicated by the 2D graphs can be visualized by looking at the extreme structures that were generated by <code>-extr</code> of <code>gmx anaeig</code>. Opening one of these PDB files in PyMOL gives us a protein structure with two frames. Each frame represents the first and last eigenvectors, which are depicted in the 2D graph as the X- and Y-axes, respectively.</p>
<p>If your 2D graphs show any regions without overlap, these two frames should be different when you toggle between them. We can add arrow indicators to show the degree and direction of these differences using <code>modevectors</code>.</p>
<p>To do this, you will need the <a href="https://pymolwiki.org/index.php/Modevectors"><code>modevectors.py</code> script</a>. You can additionally use the optional <code>modesplit.py</code> script, which automates part of this process with a little extra set-up. Place all scripts in the same directory as the PDB files you are working with.</p>
<h4 id="using-modevectorspy">Using <code>modevectors.py</code></h4>
<p>The <code>modevectors.py</code> script requires that the two frames be split into two PyMOL objects. This can be done through the graphical user interface (GUI) or the PyMOL command line.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">GUI</label><label for="__tabbed_1_2">Command line</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>To do this in the PyMOL GUI, find the object buttons at the right of the program. Navigate to either your protein or the "all" object and click the A icon.</p>
<p>Navigate to the "state" option, then select "split".
<figure markdown="span">
<img alt="PyMOL graphical interface depicting the state &gt; split options" src="../../../assets/pca/modevec_01.png" />
 </figure></p>
<p>This will create 2 new objects, "<em>protein</em>_0001" and "<em>protein</em>_0002", which correspond to the two frames.</p>
<hr />
</div>
<div class="tabbed-block">
<p>To do this in the PyMOL command line, type <code>split_states all</code>.
<figure markdown="span">
<img alt="PyMOL terminal with the split_states all command" src="../../../assets/pca/modevec_02.png" />
</figure>
This will create 2 new objects, "<em>protein</em>_0001" and "<em>protein</em>_0002", which correspond to the two frames.</p>
<hr />
</div>
</div>
</div>
<p>You can now use <code>modevectors.py</code>! Run each of the following lines individually in the PyMOL command line, replacing the object names as appropriate:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>run modevectors.py
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>modevectors first_obj_frame, last_obj_frame, skip=0
</span></code></pre></div>
<p><code>skip</code> indicates how many vectors (arrows) are skipped during rendering. Adjust this if the final render is too visually cluttered.</p>
<h4 id="using-modesplitpy">Using <code>modesplit.py</code></h4>
<p>Repeatedly running Modevectors can be tedious if you are analyzing multiple systems with the same protein, or multi-subunit systems where you want to analyze each subunit individually. The <code>modesplit.py</code> script is an additional (optional) script that can split subunits and automate the above process. It requires some set-up, but afterwards the script can be run as-is for all relevant PDB files.</p>
<p>Open <code>modesplit.py</code> in a code editor. Define all protein subunits in the <code>#CHAINS</code> dictionary. The dictionary can be modified for any number of subunits, but at least one entry is required to run.</p>
<p>Note that the <code>start_index</code> and <code>end_index</code> ask for the index of the first and last <em>atoms</em> of the subunit, not residues. This is to avoid duplicates with homo-oligomers, which will have the same residue numbers designated across identical subunits.</p>
<p>To find the index of an atom in PyMOL:</p>
<ol>
<li>Select the first residue of the subunit. In the command line, type <code>index %sele</code> and hit enter. PyMOL will return three lines of text. Note the number at the end of the <strong>first</strong> line of the output.</li>
<li>Click off the protein to deselect the residue.</li>
<li>Repeat step 1, instead selecting the last residue of the subunit. Note the number at the end of the <strong>last</strong> line of the output.</li>
<li>Repeat for all subunits.</li>
</ol>
<figure>
  <img alt="Standard output of the index command" src="../../../assets/pca/modevec_03.png" />
  <figcaption>Output of the index command.</figcaption>
</figure>
<p>Update the indices, then save the file. Load it into PyMOL using <code>run modesplit.py</code> in the command line.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This script will also automatically run <code>modevectors.py</code>. You can adjust the parameters for Modevectors in line 47.</p>
</div>
<h3 id="analyzing-motion-with-direct-id">Analyzing motion with DIRECT-ID</h3>
<p>DIRECT-ID is a program that identifies residues with the greatest variance in movement between two systems based on the covariance matrices produced by <code>gmx covar</code>.</p>
<p>The following files are needed to perform DIRECT-ID analysis:</p>
<ul>
<li><code>ascii.dat</code> for both systems of interest</li>
<li><code>ave.pdb</code> for either system</li>
</ul>
<p>DIRECT-ID should already be set-up on ARC and can be accessed using the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>direct_id<span class="w"> </span>3NXN<span class="w"> </span>wt_ascii.dat<span class="w"> </span>mut_ascii.dat<span class="w"> </span>wt_ave.pdb<span class="w"> </span>direct_id_output.txt
</span></code></pre></div>
<p>Depending on where you are trying to run the analysis, you may need to run the command using a path to the DIRECT-ID program.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="o">(</span>../<span class="o">)</span>../../direct_id<span class="w"> </span>3NXN<span class="w"> </span>wt_ascii.dat<span class="w"> </span>mut_ascii.dat<span class="w"> </span>wt_ave.pdb<span class="w"> </span>direct_id_output.txt
</span></code></pre></div>
<p>Regardless of how the program is run, two outputs will be generated: a text file containing a list of <em>atoms</em> with the most variance in movement, and a command line output listing the <em>residues</em>.</p>
<figure>
<img alt="Terminal output after performing DIRECT-ID analysis" src="../../../assets/pca/diid_example.png" />
</figure>
<p>In most cases, the terminal output is the most relevant. Record or screenshot this output, as it does not get saved in a file. The residues listed should match those with the greatest motion in the Modevectors analysis.</p>
<h2 id="additional-resources">Additional Resources</h2>
<ul>
<li><a href="https://manual.gromacs.org/current/onlinehelp/gmx-trjcat.html">gmx trjcat</a></li>
<li><a href="https://manual.gromacs.org/current/onlinehelp/gmx-trjconv.html">gmx trjconv</a></li>
<li><a href="https://manual.gromacs.org/current/onlinehelp/gmx-convert-tpr.html">gmx convert-tpr</a></li>
<li><a href="https://manual.gromacs.org/current/onlinehelp/gmx-covar.html">gmx covar</a></li>
<li><a href="https://manual.gromacs.org/current/onlinehelp/gmx-anaeig.html">gmx anaeig</a></li>
<li><a href="https://pymolwiki.org/index.php/Modevectors">Modevectors</a></li>
<li><a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/jcc.24231">DIRECT-ID</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
    
  </body>
</html>